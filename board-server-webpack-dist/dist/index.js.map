{"version":3,"sources":["webpack://board-server-tsoa/./swagger.json","webpack://board-server-tsoa/./src/app.ts","webpack://board-server-tsoa/./src/config/config.ts","webpack://board-server-tsoa/./src/config/winston.ts","webpack://board-server-tsoa/./src/controller/auth.controller.ts","webpack://board-server-tsoa/./src/controller/board.controller.ts","webpack://board-server-tsoa/./src/controller/domain.controller.ts","webpack://board-server-tsoa/./src/controller/resource.controller.ts","webpack://board-server-tsoa/./src/enum/defineCode.ts","webpack://board-server-tsoa/./src/enum/httpStatusCode.ts","webpack://board-server-tsoa/./src/models/board.ts","webpack://board-server-tsoa/./src/models/domain.ts","webpack://board-server-tsoa/./src/models/index.ts","webpack://board-server-tsoa/./src/models/resource.ts","webpack://board-server-tsoa/./src/models/sequelize.ts","webpack://board-server-tsoa/./src/routes/routes.ts","webpack://board-server-tsoa/./src/server.ts","webpack://board-server-tsoa/./src/services/auth.ts","webpack://board-server-tsoa/./src/services/board.ts","webpack://board-server-tsoa/./src/services/domain.ts","webpack://board-server-tsoa/./src/services/resource.ts","webpack://board-server-tsoa/./src/services/token.ts","webpack://board-server-tsoa/external \"app-root-path\"","webpack://board-server-tsoa/external \"body-parser\"","webpack://board-server-tsoa/external \"cookie-parser\"","webpack://board-server-tsoa/external \"cors\"","webpack://board-server-tsoa/external \"dotenv\"","webpack://board-server-tsoa/external \"express\"","webpack://board-server-tsoa/external \"express-ip\"","webpack://board-server-tsoa/external \"express-session\"","webpack://board-server-tsoa/external \"fs\"","webpack://board-server-tsoa/external \"jsonfile\"","webpack://board-server-tsoa/external \"jsonwebtoken\"","webpack://board-server-tsoa/external \"moment-timezone\"","webpack://board-server-tsoa/external \"morgan\"","webpack://board-server-tsoa/external \"multer\"","webpack://board-server-tsoa/external \"path\"","webpack://board-server-tsoa/external \"sequelize\"","webpack://board-server-tsoa/external \"split\"","webpack://board-server-tsoa/external \"swagger-ui-express\"","webpack://board-server-tsoa/external \"tsoa\"","webpack://board-server-tsoa/external \"uuid\"","webpack://board-server-tsoa/external \"winston\"","webpack://board-server-tsoa/external \"winston-daily-rotate-file\"","webpack://board-server-tsoa/webpack/bootstrap","webpack://board-server-tsoa/webpack/runtime/define property getters","webpack://board-server-tsoa/webpack/runtime/hasOwnProperty shorthand","webpack://board-server-tsoa/webpack/runtime/make namespace object","webpack://board-server-tsoa/webpack/runtime/publicPath","webpack://board-server-tsoa/webpack/startup"],"names":["__createBinding","this","Object","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__setModuleDefault","v","value","__importStar","mod","__esModule","result","prototype","hasOwnProperty","call","__importDefault","exports","app","express_1","body_parser_1","routes_1","swaggerUi","jsonfile_1","morgan_1","dotenv_1","fs_1","cookie_parser_1","express_session_1","path_1","cors_1","express_ip_1","winston_1","moment_timezone_1","default","config","use","urlencoded","extended","json","getIpInfoMiddleware","process","env","COOKIE_SECRET","sessionOption","resave","saveUninitialized","secret","cookie","httpOnly","secure","sessionMiddleware","readdirSync","error","info","mkdirSync","set","static","join","__dirname","token","tz","format","stream","PORT","HOST","sequelize","sync","force","then","catch","err","allowedHeaders","methods","origin","credentials","preflightContinue","console","log","swaggerPath","swaggerDoc","readFileSync","serve","setup","RegisterRoutes","req","res","sendFile","DB_USERNAME","DB_PASSWORD","DB_HOST","app_root_path_1","split_1","winston_daily_rotate_file_1","today","Date","appendTimestamp","getFullYear","getMonth","getDate","opts","timestamp","options","file","level","dirname","filename","handleExceptions","maxsize","maxFiles","colorize","combine","printf","pid","message","logger","createLogger","transports","Console","exitOnError","on","__decorate","decorators","target","key","desc","d","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","__metadata","metadata","__param","paramIndex","decorator","AuthController","tsoa_1","token_1","httpStatusCode_1","defineCode_1","Controller","body","Promise","resolve","reject","clientSecret","get_token","code","UNAUTHORIZED","setStatus","success","match","ERROR_CODE_OTHER","Post","Request","Body","Function","Route","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","next","e","rejected","done","apply","BoardController","board_1","page","pageSize","maxSize","selectList","INTERNAL_SERVER_ERROR","id","selectOne","form","insert","Security","Get","Query","Number","Path","DomainController","domain_1","host","insertDomain","selectAllDomain","ResourceController","resource_1","fileUploadResult","handleFile","resource","path","originFileName","originalname","fileSize","size","savedFileName","mimeType","mimetype","insertResource","originName","request","ERROR_CODE_DATA_NOT_EXIST","data","imgMime","response","setHeader","encodeURI","filestream","createReadStream","pipe","end","ERROR_CODE_AUTH_FAILED","RESOURCE_PATH","RESOURCE_CLIENT_PATH","RESOURCE_MAX_SIZE","HttpStatusCode","associate","sequelize_1","sequelize_2","Board","Model","init","title","type","DataTypes","STRING","allowNull","content","TEXT","nick","ridx","INTEGER","modelName","tableName","charset","collate","db","Domain","UUID","__exportStar","p","Resource","config_1","database","username","password","Sequelize","auth_controller_1","board_controller_1","domain_controller_1","resource_controller_1","auth_1","validationService","ValidationService","authenticateMiddleware","security","_response","responded","succeed","user","fail","status","secMethod","keys","promises","name","push","expressAuthentication","all","users","promiseHandler","controllerObj","promise","statusCode","object","headers","getHeaders","forEach","getStatus","readable","_read","getValidatedArgs","args","fieldErrors","values","map","in","ValidateParam","query","params","header","ValidateError","post","validatedArgs","controller","token_issue","select_list","select_one","insert_board","select_all","getImage","app_1","listen","noneAuth","jwtAuth","jsonwebtoken_1","securityName","scopes","_token","split","JWT_SECRET","decoded","verify","Error","send","curPage","skipSize","collectionSize","count","findAll","order","limit","offset","NO_CONTENT","list","pager","OK","findOne","where","uuid_1","exist","v4","multer_1","dest","limits","single","sign","expiresIn","issuer","module","require","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","definition","obj","prop","Symbol","toStringTag"],"mappings":"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","file":"index.js","sourcesContent":["export default __webpack_public_path__ + \"8239ad125e42bef4f510f3de4b0d5f26.json\";","\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.app = void 0;\r\n// src/app.ts\r\nconst express_1 = __importDefault(require(\"express\"));\r\nconst body_parser_1 = __importDefault(require(\"body-parser\"));\r\nconst routes_1 = require(\"./routes/routes\");\r\nconst swaggerUi = __importStar(require(\"swagger-ui-express\"));\r\nconst jsonfile_1 = __importDefault(require(\"jsonfile\"));\r\nconst morgan_1 = __importDefault(require(\"morgan\"));\r\nconst dotenv_1 = __importDefault(require(\"dotenv\"));\r\nconst fs_1 = __importDefault(require(\"fs\"));\r\nconst cookie_parser_1 = __importDefault(require(\"cookie-parser\"));\r\nconst express_session_1 = __importDefault(require(\"express-session\"));\r\nconst path_1 = __importDefault(require(\"path\"));\r\nconst cors_1 = __importDefault(require(\"cors\"));\r\nconst express_ip_1 = __importDefault(require(\"express-ip\"));\r\nconst winston_1 = __importStar(require(\"./config/winston\"));\r\nconst moment_timezone_1 = __importDefault(require(\"moment-timezone\"));\r\nexports.app = express_1.default();\r\ndotenv_1.default.config();\r\n// Use body parser to read sent json payloads\r\nexports.app.use(body_parser_1.default.urlencoded({\r\n    extended: true,\r\n}));\r\nexports.app.use(body_parser_1.default.json());\r\nexports.app.use(express_ip_1.default().getIpInfoMiddleware);\r\n//passportConfig();   //passport config\r\n//cookie-parser\r\nexports.app.use(cookie_parser_1.default(process.env.COOKIE_SECRET));\r\n//session\r\nconst sessionOption = {\r\n    resave: false,\r\n    saveUninitialized: false,\r\n    secret: process.env.COOKIE_SECRET,\r\n    cookie: {\r\n        httpOnly: true,\r\n        secure: false,\r\n    },\r\n};\r\nconst sessionMiddleware = express_session_1.default(sessionOption);\r\nexports.app.use(sessionMiddleware);\r\n//server upload storage\r\ntry {\r\n    fs_1.default.readdirSync('resources');\r\n}\r\ncatch (error) {\r\n    winston_1.default.info('resources is null directory, now mkdir');\r\n    fs_1.default.mkdirSync('resources');\r\n}\r\n//view engine\r\nexports.app.set('view engine', 'html');\r\n//static path\r\nexports.app.use(express_1.default.static(path_1.default.join(__dirname, './www')));\r\nexports.app.use('/img', express_1.default.static(path_1.default.join(__dirname, 'resources')));\r\n//morgan logger option\r\nmorgan_1.default.token('date', () => {\r\n    return moment_timezone_1.default().tz('Asia/Seoul').format();\r\n});\r\nexports.app.use(morgan_1.default(':remote-addr - :remote-user [:date[clf]] \":method :url HTTP/:http-version\" :status :response-time ms :res[content-length] \":referrer\" \":user-agent\"', {\r\n    stream: winston_1.stream\r\n}));\r\nif (process.env.NODE_ENV === 'production') {\r\n    exports.app.use(morgan_1.default('combined'));\r\n}\r\nelse {\r\n    exports.app.use(morgan_1.default('dev'));\r\n}\r\n//port, host setting \r\nexports.app.set('port', process.env.PORT || 8080);\r\nexports.app.set('host', `${process.env.HOST}` || 'localhost');\r\nwinston_1.default.info(`port set : ${exports.app.get('port')}, host set : ${exports.app.get('host')}`);\r\n//Database Connection\r\nconst { sequelize } = require('./models');\r\nsequelize.sync({ force: false })\r\n    .then(() => {\r\n    winston_1.default.info('Connect MariaDB!');\r\n})\r\n    .catch((err) => {\r\n    winston_1.default.error(`[Error] Connect MariaDB`, err);\r\n});\r\n//Allow Cors\r\nexports.app.use(cors_1.default({\r\n    allowedHeaders: [\"Origin\", \"X-Requested-With\", \"Content-Type\", \"Accept\", \"X-Access-Token\", \"authorization\", \"Access-Control-Allow-Origin\"],\r\n    methods: \"GET,HEAD,OPTIONS,PUT,PATCH,POST,DELETE\",\r\n    origin: ['*', 'http://localhost:4200', 'http://localhost:4201', 'http://localhost:8080'],\r\n    credentials: true,\r\n    preflightContinue: false,\r\n}));\r\nconsole.log(path_1.default.join(__dirname, 'resources'));\r\n//Swagger config\r\ntry {\r\n    switch (process.env.NODE_ENV) {\r\n        case 'development':\r\n            var swaggerDoc = require('../swagger.json');\r\n            exports.app.use('/swagger', swaggerUi.serve, swaggerUi.setup(swaggerDoc));\r\n            winston_1.default.info('Swagger config success : development mode');\r\n            break;\r\n        case 'production':\r\n            var swaggerPath = require('../swagger.json');\r\n            var swaggerDoc = jsonfile_1.default.readFileSync(`./dist/${swaggerPath.default}`);\r\n            exports.app.use('/swagger', swaggerUi.serve, swaggerUi.setup(swaggerDoc));\r\n            winston_1.default.info('Swagger config success : production mode');\r\n            break;\r\n        default:\r\n            winston_1.default.error(`[Error] Fail to swagger config`);\r\n            break;\r\n    }\r\n}\r\ncatch (err) {\r\n    winston_1.default.error(`[Error] Fail to swagger config`, err);\r\n}\r\n//Routes config\r\nroutes_1.RegisterRoutes(exports.app);\r\nexports.app.get('/', (req, res) => {\r\n    if (process.env.NODE_ENV === 'production') {\r\n        res.sendFile(path_1.default.join(__dirname, './www', \"index.html\"));\r\n    }\r\n    else {\r\n        res.sendFile(path_1.default.join(__dirname, './www', \"index.html\"));\r\n    }\r\n});\r\n","\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst dotenv = __importStar(require(\"dotenv\"));\r\ndotenv.config();\r\nconst config = {\r\n    \"development\": {\r\n        \"username\": process.env.DB_USERNAME || \"root\",\r\n        \"password\": process.env.DB_PASSWORD || \"root\",\r\n        \"database\": \"board-system\",\r\n        \"host\": process.env.DB_HOST || \"127.0.0.1\",\r\n        \"dialect\": \"mysql\",\r\n        \"dialectOptions\": {\r\n            \"charset\": \"utf8mb4\",\r\n            \"dateStrings\": true,\r\n            \"typeCast\": true\r\n        },\r\n        \"timezone\": \"+09:00\",\r\n    },\r\n    \"test\": {\r\n        \"username\": process.env.DB_USERNAME || \"root\",\r\n        \"password\": process.env.DB_PASSWORD || \"root\",\r\n        \"database\": \"board-system\",\r\n        \"host\": process.env.DB_HOST || \"127.0.0.1\",\r\n        \"dialect\": \"mysql\",\r\n        \"dialectOptions\": {\r\n            \"charset\": \"utf8mb4\",\r\n            \"dateStrings\": true,\r\n            \"typeCast\": true\r\n        },\r\n        \"timezone\": \"+09:00\",\r\n    },\r\n    \"production\": {\r\n        \"username\": process.env.DB_USERNAME || \"root\",\r\n        \"password\": process.env.DB_PASSWORD || \"root\",\r\n        \"database\": \"board-system\",\r\n        \"host\": process.env.DB_HOST || 'localhost',\r\n        \"port\": 3306,\r\n        \"dialect\": \"mysql\",\r\n        \"dialectOptions\": {\r\n            \"charset\": \"utf8mb4\",\r\n            \"dateStrings\": true,\r\n            \"typeCast\": true\r\n        },\r\n        \"timezone\": \"+09:00\",\r\n    }\r\n};\r\nexports.default = config;\r\n","\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.stream = void 0;\r\nconst app_root_path_1 = __importDefault(require(\"app-root-path\"));\r\nconst winston_1 = __importStar(require(\"winston\"));\r\nconst split_1 = __importDefault(require(\"split\"));\r\nconst winston_daily_rotate_file_1 = __importDefault(require(\"winston-daily-rotate-file\"));\r\nconst moment_timezone_1 = __importDefault(require(\"moment-timezone\"));\r\nconst today = new Date();\r\nconst todayStr = `${today.getFullYear()}-${(today.getMonth() + 1) <= 9 ? '0' + (today.getMonth() + 1) : (today.getMonth() + 1)}-${today.getDate() <= 9 ? '0' + today.getDate() : today.getDate() + 1}`;\r\n// define the custom settings for each transport (file, console)\r\n// Winstone set timezone https://november11tech.tistory.com/147\r\nconst appendTimestamp = winston_1.format((info, opts) => {\r\n    if (opts.tz)\r\n        info.timestamp = moment_timezone_1.default().tz(opts.tz).format();\r\n    return info;\r\n});\r\nconst options = {\r\n    file: {\r\n        level: 'info',\r\n        dirname: `${app_root_path_1.default}/log`,\r\n        filename: `app.log`,\r\n        handleExceptions: true,\r\n        json: false,\r\n        maxsize: 5242880,\r\n        maxFiles: '30d',\r\n        colorize: false\r\n    },\r\n    console: {\r\n        level: 'debug',\r\n        handleExceptions: true,\r\n        timestamp: () => moment_timezone_1.default().format('YYYY-MM-DD hh:mm:ss'),\r\n        json: true,\r\n        colorize: true,\r\n        format: winston_1.format.combine(appendTimestamp({ tz: 'Asia/Seoul' }), winston_1.format.json(), winston_1.format.printf(info => {\r\n            return `${info.timestamp} - ${info.level} [${process.pid}]: ${info.message}`;\r\n        }))\r\n    },\r\n};\r\n// instantiate a new Winston Logger with the settings defined above\r\nconst logger = winston_1.createLogger({\r\n    transports: [\r\n        // new winston.transports.File(options.file),\r\n        new winston_daily_rotate_file_1.default(options.file),\r\n        new winston_1.default.transports.Console(options.console)\r\n    ],\r\n    exitOnError: false,\r\n    format: winston_1.format.combine(appendTimestamp({ tz: 'Asia/Seoul' }), winston_1.format.json(), winston_1.format.printf(info => {\r\n        return `${info.timestamp} - ${info.level} [${process.pid}]: ${info.message}`;\r\n    }))\r\n});\r\n// create a stream object with a 'write' function that will be used by `morgan`\r\nconst stream = split_1.default().on('data', (message) => { logger.info(`pid-${process.pid}- ${message}`); });\r\nexports.stream = stream;\r\nexports.default = logger;\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.AuthController = void 0;\r\nconst tsoa_1 = require(\"tsoa\");\r\nconst token_1 = require(\"../services/token\");\r\nconst httpStatusCode_1 = __importDefault(require(\"../enum/httpStatusCode\"));\r\nconst defineCode_1 = __importDefault(require(\"../enum/defineCode\"));\r\nconst winston_1 = __importDefault(require(\"../config/winston\"));\r\nlet AuthController = class AuthController extends tsoa_1.Controller {\r\n    token_issue(req, body) {\r\n        return new Promise((resolve, reject) => {\r\n            const { clientSecret } = body;\r\n            token_1.get_token(clientSecret)\r\n                .then(result => {\r\n                console.log(result);\r\n                if (result.code === httpStatusCode_1.default.UNAUTHORIZED) {\r\n                    this.setStatus(httpStatusCode_1.default.UNAUTHORIZED);\r\n                }\r\n                resolve(result);\r\n            })\r\n                .catch(error => {\r\n                console.log(error);\r\n                reject(error);\r\n            });\r\n        })\r\n            .catch(error => {\r\n            winston_1.default.error(`[POST] [auth] [token] Failed to get token: ${error.message}`);\r\n            return {\r\n                success: false,\r\n                message: error.message,\r\n                code: error.message.match(/(\\[[0-9]{3}\\])(\\w+)/) && error.message.match(/(\\[[0-9]{3}\\])(\\w+)/).length === 3 ? error.message.match(/(\\[[0-9]{3}\\])(\\w+)/)[1] : defineCode_1.default.ERROR_CODE_OTHER\r\n            };\r\n        });\r\n    }\r\n};\r\n__decorate([\r\n    tsoa_1.Post(\"token\"),\r\n    __param(0, tsoa_1.Request()), __param(1, tsoa_1.Body()),\r\n    __metadata(\"design:type\", Function),\r\n    __metadata(\"design:paramtypes\", [Object, Object]),\r\n    __metadata(\"design:returntype\", Promise)\r\n], AuthController.prototype, \"token_issue\", null);\r\nAuthController = __decorate([\r\n    tsoa_1.Route(\"auth\")\r\n], AuthController);\r\nexports.AuthController = AuthController;\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BoardController = void 0;\r\nconst tsoa_1 = require(\"tsoa\");\r\nconst board_1 = require(\"../services/board\");\r\nconst httpStatusCode_1 = __importDefault(require(\"../enum/httpStatusCode\"));\r\nconst defineCode_1 = __importDefault(require(\"../enum/defineCode\"));\r\nconst winston_1 = __importDefault(require(\"../config/winston\"));\r\nlet BoardController = class BoardController extends tsoa_1.Controller {\r\n    select_list(req, page, pageSize, maxSize) {\r\n        return new Promise((resolve, reject) => {\r\n            board_1.selectList({ page: page, pageSize: pageSize, maxSize: maxSize })\r\n                .then(result => {\r\n                winston_1.default.info(`[GET] [board] select list`);\r\n                resolve(result);\r\n            })\r\n                .catch(error => {\r\n                reject(error);\r\n            });\r\n        })\r\n            .catch(error => {\r\n            winston_1.default.error(`[GET] [board] Failed to select one: ${error.message}`);\r\n            this.setStatus(httpStatusCode_1.default.INTERNAL_SERVER_ERROR);\r\n            return {\r\n                success: false,\r\n                message: error.message,\r\n                code: error.message.match(/(\\[[0-9]{3}\\])(\\w+)/) && error.message.match(/(\\[[0-9]{3}\\])(\\w+)/).length === 3 ? error.message.match(/(\\[[0-9]{3}\\])(\\w+)/)[1] : defineCode_1.default.ERROR_CODE_OTHER\r\n            };\r\n        });\r\n    }\r\n    select_one(req, id) {\r\n        return new Promise((resolve, reject) => {\r\n            board_1.selectOne(id)\r\n                .then(result => {\r\n                winston_1.default.info(`[GET] [board] [${id}] select one`);\r\n                resolve(result);\r\n            })\r\n                .catch(error => {\r\n                reject(error);\r\n            });\r\n        })\r\n            .catch(error => {\r\n            winston_1.default.error(`[GET] [board] [${id}] Failed to select one: ${error.message}`);\r\n            this.setStatus(httpStatusCode_1.default.INTERNAL_SERVER_ERROR);\r\n            return {\r\n                success: false,\r\n                message: error.message,\r\n                code: error.message.match(/(\\[[0-9]{3}\\])(\\w+)/) && error.message.match(/(\\[[0-9]{3}\\])(\\w+)/).length === 3 ? error.message.match(/(\\[[0-9]{3}\\])(\\w+)/)[1] : defineCode_1.default.ERROR_CODE_OTHER\r\n            };\r\n        });\r\n    }\r\n    insert_board(req, form) {\r\n        return new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {\r\n            board_1.insert(form)\r\n                .then(result => {\r\n                winston_1.default.info(`[POST] [board] insert board`);\r\n                resolve(result);\r\n            })\r\n                .catch(error => {\r\n                reject(error);\r\n            });\r\n        }))\r\n            .catch(error => {\r\n            winston_1.default.error(`[POST] [board] Failed to insert board: ${error.message}`);\r\n            this.setStatus(httpStatusCode_1.default.INTERNAL_SERVER_ERROR);\r\n            return {\r\n                success: false,\r\n                message: error.message,\r\n                code: error.message.match(/(\\[[0-9]{3}\\])(\\w+)/) && error.message.match(/(\\[[0-9]{3}\\])(\\w+)/).length === 3 ? error.message.match(/(\\[[0-9]{3}\\])(\\w+)/)[1] : defineCode_1.default.ERROR_CODE_OTHER\r\n            };\r\n        });\r\n    }\r\n};\r\n__decorate([\r\n    tsoa_1.Security('jwt', []),\r\n    tsoa_1.Get(),\r\n    __param(0, tsoa_1.Request()), __param(1, tsoa_1.Query()), __param(2, tsoa_1.Query()), __param(3, tsoa_1.Query()),\r\n    __metadata(\"design:type\", Function),\r\n    __metadata(\"design:paramtypes\", [Object, Number, Number, Number]),\r\n    __metadata(\"design:returntype\", Promise)\r\n], BoardController.prototype, \"select_list\", null);\r\n__decorate([\r\n    tsoa_1.Security('jwt', []),\r\n    tsoa_1.Get(\"{id}\"),\r\n    __param(0, tsoa_1.Request()), __param(1, tsoa_1.Path()),\r\n    __metadata(\"design:type\", Function),\r\n    __metadata(\"design:paramtypes\", [Object, Number]),\r\n    __metadata(\"design:returntype\", Promise)\r\n], BoardController.prototype, \"select_one\", null);\r\n__decorate([\r\n    tsoa_1.Security('jwt', []),\r\n    tsoa_1.Post(),\r\n    __param(0, tsoa_1.Request()), __param(1, tsoa_1.Body()),\r\n    __metadata(\"design:type\", Function),\r\n    __metadata(\"design:paramtypes\", [Object, Object]),\r\n    __metadata(\"design:returntype\", Promise)\r\n], BoardController.prototype, \"insert_board\", null);\r\nBoardController = __decorate([\r\n    tsoa_1.Route(\"board\")\r\n], BoardController);\r\nexports.BoardController = BoardController;\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.DomainController = void 0;\r\nconst tsoa_1 = require(\"tsoa\");\r\nconst domain_1 = require(\"../services/domain\");\r\nconst defineCode_1 = __importDefault(require(\"../enum/defineCode\"));\r\nconst winston_1 = __importDefault(require(\"../config/winston\"));\r\nlet DomainController = class DomainController extends tsoa_1.Controller {\r\n    insert(req, form) {\r\n        return new Promise((resolve, reject) => {\r\n            const { host } = form;\r\n            domain_1.insertDomain(host)\r\n                .then(result => {\r\n                winston_1.default.info(`[POST] [domain] insert domain`);\r\n                resolve(result);\r\n            })\r\n                .catch(error => {\r\n                console.log(error);\r\n                reject(error);\r\n            });\r\n        })\r\n            .catch(error => {\r\n            winston_1.default.error(`[POST] [domain] Failed to insert domain: ${error.message}`);\r\n            return {\r\n                success: false,\r\n                message: error.message,\r\n                code: error.message.match(/(\\[[0-9]{3}\\])(\\w+)/) && error.message.match(/(\\[[0-9]{3}\\])(\\w+)/).length === 3 ? error.message.match(/(\\[[0-9]{3}\\])(\\w+)/)[1] : defineCode_1.default.ERROR_CODE_OTHER\r\n            };\r\n        });\r\n    }\r\n    ;\r\n    select_all(req) {\r\n        return new Promise((resolve, reject) => {\r\n            const domain = domain_1.selectAllDomain()\r\n                .then(result => {\r\n                winston_1.default.info(`[GET] [domain] selectAll domain`);\r\n                resolve(result);\r\n            })\r\n                .catch(error => {\r\n                console.log(error);\r\n                reject(error);\r\n            });\r\n        })\r\n            .catch(error => {\r\n            winston_1.default.error(`[GET] [domain] Failed to selectAll domain: ${error.message}`);\r\n            return {\r\n                success: false,\r\n                message: error.message,\r\n                code: error.message.match(/(\\[[0-9]{3}\\])(\\w+)/) && error.message.match(/(\\[[0-9]{3}\\])(\\w+)/).length === 3 ? error.message.match(/(\\[[0-9]{3}\\])(\\w+)/)[1] : defineCode_1.default.ERROR_CODE_OTHER\r\n            };\r\n        });\r\n    }\r\n    ;\r\n};\r\n__decorate([\r\n    tsoa_1.Post(),\r\n    __param(0, tsoa_1.Request()), __param(1, tsoa_1.Body()),\r\n    __metadata(\"design:type\", Function),\r\n    __metadata(\"design:paramtypes\", [Object, Object]),\r\n    __metadata(\"design:returntype\", Promise)\r\n], DomainController.prototype, \"insert\", null);\r\n__decorate([\r\n    tsoa_1.Get(),\r\n    __param(0, tsoa_1.Request()),\r\n    __metadata(\"design:type\", Function),\r\n    __metadata(\"design:paramtypes\", [Object]),\r\n    __metadata(\"design:returntype\", Promise)\r\n], DomainController.prototype, \"select_all\", null);\r\nDomainController = __decorate([\r\n    tsoa_1.Route(\"domain\")\r\n], DomainController);\r\nexports.DomainController = DomainController;\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ResourceController = void 0;\r\nconst tsoa_1 = require(\"tsoa\");\r\nconst httpStatusCode_1 = __importDefault(require(\"../enum/httpStatusCode\"));\r\nconst defineCode_1 = __importDefault(require(\"../enum/defineCode\"));\r\nconst resource_1 = require(\"../services/resource\");\r\nconst fs_1 = __importDefault(require(\"fs\"));\r\nconst winston_1 = __importDefault(require(\"../config/winston\"));\r\nlet ResourceController = class ResourceController extends tsoa_1.Controller {\r\n    insert(req) {\r\n        return new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {\r\n            const fileUploadResult = yield resource_1.handleFile(req);\r\n            console.log(fileUploadResult.resource);\r\n            const path = `${fileUploadResult.resource.path}`;\r\n            const originFileName = `${fileUploadResult.resource.originalname}`;\r\n            const fileSize = fileUploadResult.resource.size;\r\n            const savedFileName = `${fileUploadResult.resource.filename}`;\r\n            const mimeType = `${fileUploadResult.resource.mimetype}`;\r\n            resource_1.insertResource({\r\n                originName: originFileName,\r\n                fileSize: fileSize,\r\n                savedFileName: savedFileName,\r\n                path: path,\r\n                mimeType: mimeType\r\n            })\r\n                .then(result => {\r\n                winston_1.default.info(`[POST] [resource] [single] insert resource`);\r\n                resolve(result);\r\n            })\r\n                .catch(error => {\r\n                console.log(error);\r\n                reject(error);\r\n            });\r\n        }))\r\n            .catch(error => {\r\n            winston_1.default.error(`[POST] [resource] [single] Faild to insert resource : ${error.message}`);\r\n            return {\r\n                success: false,\r\n                message: error.message,\r\n                code: error.message.match(/(\\[[0-9]{3}\\])(\\w+)/) && error.message.match(/(\\[[0-9]{3}\\])(\\w+)/).length === 3 ? error.message.match(/(\\[[0-9]{3}\\])(\\w+)/)[1] : defineCode_1.default.ERROR_CODE_OTHER\r\n            };\r\n        });\r\n    }\r\n    ;\r\n    getImage(request, id) {\r\n        return new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {\r\n            resource_1.selectOne(id)\r\n                .then((result) => __awaiter(this, void 0, void 0, function* () {\r\n                if (result.success == false) {\r\n                    reject(`${defineCode_1.default.ERROR_CODE_DATA_NOT_EXIST}File not exist.`);\r\n                    return;\r\n                }\r\n                const path = result.data.path;\r\n                const imgMime = result.data.mimeType;\r\n                const response = request.res;\r\n                response.setHeader('Content-Type', imgMime);\r\n                response.setHeader('Content-Disposition', `attachment; filename=${encodeURI(result.data.originName)}`);\r\n                const filestream = fs_1.default.createReadStream(path);\r\n                filestream.pipe(response);\r\n                return yield filestream.on('end', () => {\r\n                    winston_1.default.info(`[GET] [resource] [image] [id : ${id}] get image resource`);\r\n                    response.end();\r\n                    return;\r\n                });\r\n            }))\r\n                .catch(error => {\r\n                console.log(error);\r\n                reject(error);\r\n                return;\r\n            });\r\n        }))\r\n            .catch(error => {\r\n            winston_1.default.error(`[GET] [resource] [image] [id : ${id}] Faild to get image resource : ${error.message}`);\r\n            this.setStatus(httpStatusCode_1.default.INTERNAL_SERVER_ERROR);\r\n            return {\r\n                success: false,\r\n                message: error.message,\r\n                code: error.message.match(/(\\[[0-9]{3}\\])(\\w+)/) && error.message.match(/(\\[[0-9]{3}\\])(\\w+)/).length === 3 ? error.message.match(/(\\[[0-9]{3}\\])(\\w+)/)[1] : defineCode_1.default.ERROR_CODE_OTHER\r\n            };\r\n        });\r\n    }\r\n};\r\n__decorate([\r\n    tsoa_1.Post(\"single\"),\r\n    __param(0, tsoa_1.Request()),\r\n    __metadata(\"design:type\", Function),\r\n    __metadata(\"design:paramtypes\", [Object]),\r\n    __metadata(\"design:returntype\", Promise)\r\n], ResourceController.prototype, \"insert\", null);\r\n__decorate([\r\n    tsoa_1.Get('/image'),\r\n    __param(0, tsoa_1.Request()), __param(1, tsoa_1.Query()),\r\n    __metadata(\"design:type\", Function),\r\n    __metadata(\"design:paramtypes\", [Object, Number]),\r\n    __metadata(\"design:returntype\", Promise)\r\n], ResourceController.prototype, \"getImage\", null);\r\nResourceController = __decorate([\r\n    tsoa_1.Route(\"resource\")\r\n], ResourceController);\r\nexports.ResourceController = ResourceController;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst DefineCode = {\r\n    ERROR_CODE_OTHER: '[000]',\r\n    ERROR_CODE_DATA_NOT_EXIST: '[404]',\r\n    ERROR_CODE_AUTH_FAILED: '[500]',\r\n    RESOURCE_PATH: 'resources/',\r\n    RESOURCE_CLIENT_PATH: '/img/',\r\n    RESOURCE_MAX_SIZE: 5 * 1024 * 1024,\r\n};\r\nexports.default = DefineCode;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Hypertext Transfer Protocol (HTTP) response status codes.\r\n * @see {@link https://en.wikipedia.org/wiki/List_of_HTTP_status_codes}\r\n */\r\nvar HttpStatusCode;\r\n(function (HttpStatusCode) {\r\n    /**\r\n     * The server has received the request headers and the client should proceed to send the request body\r\n     * (in the case of a request for which a body needs to be sent; for example, a POST request).\r\n     * Sending a large request body to a server after a request has been rejected for inappropriate headers would be inefficient.\r\n     * To have a server check the request's headers, a client must send Expect: 100-continue as a header in its initial request\r\n     * and receive a 100 Continue status code in response before sending the body. The response 417 Expectation Failed indicates the request should not be continued.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"CONTINUE\"] = 100] = \"CONTINUE\";\r\n    /**\r\n     * The requester has asked the server to switch protocols and the server has agreed to do so.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"SWITCHING_PROTOCOLS\"] = 101] = \"SWITCHING_PROTOCOLS\";\r\n    /**\r\n     * A WebDAV request may contain many sub-requests involving file operations, requiring a long time to complete the request.\r\n     * This code indicates that the server has received and is processing the request, but no response is available yet.\r\n     * This prevents the client from timing out and assuming the request was lost.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"PROCESSING\"] = 102] = \"PROCESSING\";\r\n    /**\r\n     * Standard response for successful HTTP requests.\r\n     * The actual response will depend on the request method used.\r\n     * In a GET request, the response will contain an entity corresponding to the requested resource.\r\n     * In a POST request, the response will contain an entity describing or containing the result of the action.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"OK\"] = 200] = \"OK\";\r\n    /**\r\n     * The request has been fulfilled, resulting in the creation of a new resource.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"CREATED\"] = 201] = \"CREATED\";\r\n    /**\r\n     * The request has been accepted for processing, but the processing has not been completed.\r\n     * The request might or might not be eventually acted upon, and may be disallowed when processing occurs.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"ACCEPTED\"] = 202] = \"ACCEPTED\";\r\n    /**\r\n     * SINCE HTTP/1.1\r\n     * The server is a transforming proxy that received a 200 OK from its origin,\r\n     * but is returning a modified version of the origin's response.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"NON_AUTHORITATIVE_INFORMATION\"] = 203] = \"NON_AUTHORITATIVE_INFORMATION\";\r\n    /**\r\n     * The server successfully processed the request and is not returning any content.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"NO_CONTENT\"] = 204] = \"NO_CONTENT\";\r\n    /**\r\n     * The server successfully processed the request, but is not returning any content.\r\n     * Unlike a 204 response, this response requires that the requester reset the document view.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"RESET_CONTENT\"] = 205] = \"RESET_CONTENT\";\r\n    /**\r\n     * The server is delivering only part of the resource (byte serving) due to a range header sent by the client.\r\n     * The range header is used by HTTP clients to enable resuming of interrupted downloads,\r\n     * or split a download into multiple simultaneous streams.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"PARTIAL_CONTENT\"] = 206] = \"PARTIAL_CONTENT\";\r\n    /**\r\n     * The message body that follows is an XML message and can contain a number of separate response codes,\r\n     * depending on how many sub-requests were made.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"MULTI_STATUS\"] = 207] = \"MULTI_STATUS\";\r\n    /**\r\n     * The members of a DAV binding have already been enumerated in a preceding part of the (multistatus) response,\r\n     * and are not being included again.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"ALREADY_REPORTED\"] = 208] = \"ALREADY_REPORTED\";\r\n    /**\r\n     * The server has fulfilled a request for the resource,\r\n     * and the response is a representation of the result of one or more instance-manipulations applied to the current instance.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"IM_USED\"] = 226] = \"IM_USED\";\r\n    /**\r\n     * Indicates multiple options for the resource from which the client may choose (via agent-driven content negotiation).\r\n     * For example, this code could be used to present multiple video format options,\r\n     * to list files with different filename extensions, or to suggest word-sense disambiguation.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"MULTIPLE_CHOICES\"] = 300] = \"MULTIPLE_CHOICES\";\r\n    /**\r\n     * This and all future requests should be directed to the given URI.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"MOVED_PERMANENTLY\"] = 301] = \"MOVED_PERMANENTLY\";\r\n    /**\r\n     * This is an example of industry practice contradicting the standard.\r\n     * The HTTP/1.0 specification (RFC 1945) required the client to perform a temporary redirect\r\n     * (the original describing phrase was \"Moved Temporarily\"), but popular browsers implemented 302\r\n     * with the functionality of a 303 See Other. Therefore, HTTP/1.1 added status codes 303 and 307\r\n     * to distinguish between the two behaviours. However, some Web applications and frameworks\r\n     * use the 302 status code as if it were the 303.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"FOUND\"] = 302] = \"FOUND\";\r\n    /**\r\n     * SINCE HTTP/1.1\r\n     * The response to the request can be found under another URI using a GET method.\r\n     * When received in response to a POST (or PUT/DELETE), the client should presume that\r\n     * the server has received the data and should issue a redirect with a separate GET message.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"SEE_OTHER\"] = 303] = \"SEE_OTHER\";\r\n    /**\r\n     * Indicates that the resource has not been modified since the version specified by the request headers If-Modified-Since or If-None-Match.\r\n     * In such case, there is no need to retransmit the resource since the client still has a previously-downloaded copy.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"NOT_MODIFIED\"] = 304] = \"NOT_MODIFIED\";\r\n    /**\r\n     * SINCE HTTP/1.1\r\n     * The requested resource is available only through a proxy, the address for which is provided in the response.\r\n     * Many HTTP clients (such as Mozilla and Internet Explorer) do not correctly handle responses with this status code, primarily for security reasons.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"USE_PROXY\"] = 305] = \"USE_PROXY\";\r\n    /**\r\n     * No longer used. Originally meant \"Subsequent requests should use the specified proxy.\"\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"SWITCH_PROXY\"] = 306] = \"SWITCH_PROXY\";\r\n    /**\r\n     * SINCE HTTP/1.1\r\n     * In this case, the request should be repeated with another URI; however, future requests should still use the original URI.\r\n     * In contrast to how 302 was historically implemented, the request method is not allowed to be changed when reissuing the original request.\r\n     * For example, a POST request should be repeated using another POST request.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"TEMPORARY_REDIRECT\"] = 307] = \"TEMPORARY_REDIRECT\";\r\n    /**\r\n     * The request and all future requests should be repeated using another URI.\r\n     * 307 and 308 parallel the behaviors of 302 and 301, but do not allow the HTTP method to change.\r\n     * So, for example, submitting a form to a permanently redirected resource may continue smoothly.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"PERMANENT_REDIRECT\"] = 308] = \"PERMANENT_REDIRECT\";\r\n    /**\r\n     * The server cannot or will not process the request due to an apparent client error\r\n     * (e.g., malformed request syntax, too large size, invalid request message framing, or deceptive request routing).\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"BAD_REQUEST\"] = 400] = \"BAD_REQUEST\";\r\n    /**\r\n     * Similar to 403 Forbidden, but specifically for use when authentication is required and has failed or has not yet\r\n     * been provided. The response must include a WWW-Authenticate header field containing a challenge applicable to the\r\n     * requested resource. See Basic access authentication and Digest access authentication. 401 semantically means\r\n     * \"unauthenticated\",i.e. the user does not have the necessary credentials.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"UNAUTHORIZED\"] = 401] = \"UNAUTHORIZED\";\r\n    /**\r\n     * Reserved for future use. The original intention was that this code might be used as part of some form of digital\r\n     * cash or micro payment scheme, but that has not happened, and this code is not usually used.\r\n     * Google Developers API uses this status if a particular developer has exceeded the daily limit on requests.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"PAYMENT_REQUIRED\"] = 402] = \"PAYMENT_REQUIRED\";\r\n    /**\r\n     * The request was valid, but the server is refusing action.\r\n     * The user might not have the necessary permissions for a resource.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"FORBIDDEN\"] = 403] = \"FORBIDDEN\";\r\n    /**\r\n     * The requested resource could not be found but may be available in the future.\r\n     * Subsequent requests by the client are permissible.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"NOT_FOUND\"] = 404] = \"NOT_FOUND\";\r\n    /**\r\n     * A request method is not supported for the requested resource;\r\n     * for example, a GET request on a form that requires data to be presented via POST, or a PUT request on a read-only resource.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"METHOD_NOT_ALLOWED\"] = 405] = \"METHOD_NOT_ALLOWED\";\r\n    /**\r\n     * The requested resource is capable of generating only content not acceptable according to the Accept headers sent in the request.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"NOT_ACCEPTABLE\"] = 406] = \"NOT_ACCEPTABLE\";\r\n    /**\r\n     * The client must first authenticate itself with the proxy.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"PROXY_AUTHENTICATION_REQUIRED\"] = 407] = \"PROXY_AUTHENTICATION_REQUIRED\";\r\n    /**\r\n     * The server timed out waiting for the request.\r\n     * According to HTTP specifications:\r\n     * \"The client did not produce a request within the time that the server was prepared to wait. The client MAY repeat the request without modifications at any later time.\"\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"REQUEST_TIMEOUT\"] = 408] = \"REQUEST_TIMEOUT\";\r\n    /**\r\n     * Indicates that the request could not be processed because of conflict in the request,\r\n     * such as an edit conflict between multiple simultaneous updates.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"CONFLICT\"] = 409] = \"CONFLICT\";\r\n    /**\r\n     * Indicates that the resource requested is no longer available and will not be available again.\r\n     * This should be used when a resource has been intentionally removed and the resource should be purged.\r\n     * Upon receiving a 410 status code, the client should not request the resource in the future.\r\n     * Clients such as search engines should remove the resource from their indices.\r\n     * Most use cases do not require clients and search engines to purge the resource, and a \"404 Not Found\" may be used instead.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"GONE\"] = 410] = \"GONE\";\r\n    /**\r\n     * The request did not specify the length of its content, which is required by the requested resource.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"LENGTH_REQUIRED\"] = 411] = \"LENGTH_REQUIRED\";\r\n    /**\r\n     * The server does not meet one of the preconditions that the requester put on the request.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"PRECONDITION_FAILED\"] = 412] = \"PRECONDITION_FAILED\";\r\n    /**\r\n     * The request is larger than the server is willing or able to process. Previously called \"Request Entity Too Large\".\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"PAYLOAD_TOO_LARGE\"] = 413] = \"PAYLOAD_TOO_LARGE\";\r\n    /**\r\n     * The URI provided was too long for the server to process. Often the result of too much data being encoded as a query-string of a GET request,\r\n     * in which case it should be converted to a POST request.\r\n     * Called \"Request-URI Too Long\" previously.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"URI_TOO_LONG\"] = 414] = \"URI_TOO_LONG\";\r\n    /**\r\n     * The request entity has a media type which the server or resource does not support.\r\n     * For example, the client uploads an image as image/svg+xml, but the server requires that images use a different format.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"UNSUPPORTED_MEDIA_TYPE\"] = 415] = \"UNSUPPORTED_MEDIA_TYPE\";\r\n    /**\r\n     * The client has asked for a portion of the file (byte serving), but the server cannot supply that portion.\r\n     * For example, if the client asked for a part of the file that lies beyond the end of the file.\r\n     * Called \"Requested Range Not Satisfiable\" previously.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"RANGE_NOT_SATISFIABLE\"] = 416] = \"RANGE_NOT_SATISFIABLE\";\r\n    /**\r\n     * The server cannot meet the requirements of the Expect request-header field.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"EXPECTATION_FAILED\"] = 417] = \"EXPECTATION_FAILED\";\r\n    /**\r\n     * This code was defined in 1998 as one of the traditional IETF April Fools' jokes, in RFC 2324, Hyper Text Coffee Pot Control Protocol,\r\n     * and is not expected to be implemented by actual HTTP servers. The RFC specifies this code should be returned by\r\n     * teapots requested to brew coffee. This HTTP status is used as an Easter egg in some websites, including Google.com.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"I_AM_A_TEAPOT\"] = 418] = \"I_AM_A_TEAPOT\";\r\n    /**\r\n     * The request was directed at a server that is not able to produce a response (for example because a connection reuse).\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"MISDIRECTED_REQUEST\"] = 421] = \"MISDIRECTED_REQUEST\";\r\n    /**\r\n     * The request was well-formed but was unable to be followed due to semantic errors.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"UNPROCESSABLE_ENTITY\"] = 422] = \"UNPROCESSABLE_ENTITY\";\r\n    /**\r\n     * The resource that is being accessed is locked.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"LOCKED\"] = 423] = \"LOCKED\";\r\n    /**\r\n     * The request failed due to failure of a previous request (e.g., a PROPPATCH).\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"FAILED_DEPENDENCY\"] = 424] = \"FAILED_DEPENDENCY\";\r\n    /**\r\n     * The client should switch to a different protocol such as TLS/1.0, given in the Upgrade header field.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"UPGRADE_REQUIRED\"] = 426] = \"UPGRADE_REQUIRED\";\r\n    /**\r\n     * The origin server requires the request to be conditional.\r\n     * Intended to prevent \"the 'lost update' problem, where a client\r\n     * GETs a resource's state, modifies it, and PUTs it back to the server,\r\n     * when meanwhile a third party has modified the state on the server, leading to a conflict.\"\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"PRECONDITION_REQUIRED\"] = 428] = \"PRECONDITION_REQUIRED\";\r\n    /**\r\n     * The user has sent too many requests in a given amount of time. Intended for use with rate-limiting schemes.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"TOO_MANY_REQUESTS\"] = 429] = \"TOO_MANY_REQUESTS\";\r\n    /**\r\n     * The server is unwilling to process the request because either an individual header field,\r\n     * or all the header fields collectively, are too large.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"REQUEST_HEADER_FIELDS_TOO_LARGE\"] = 431] = \"REQUEST_HEADER_FIELDS_TOO_LARGE\";\r\n    /**\r\n     * A server operator has received a legal demand to deny access to a resource or to a set of resources\r\n     * that includes the requested resource. The code 451 was chosen as a reference to the novel Fahrenheit 451.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"UNAVAILABLE_FOR_LEGAL_REASONS\"] = 451] = \"UNAVAILABLE_FOR_LEGAL_REASONS\";\r\n    /**\r\n     * A generic error message, given when an unexpected condition was encountered and no more specific message is suitable.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"INTERNAL_SERVER_ERROR\"] = 500] = \"INTERNAL_SERVER_ERROR\";\r\n    /**\r\n     * The server either does not recognize the request method, or it lacks the ability to fulfill the request.\r\n     * Usually this implies future availability (e.g., a new feature of a web-service API).\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"NOT_IMPLEMENTED\"] = 501] = \"NOT_IMPLEMENTED\";\r\n    /**\r\n     * The server was acting as a gateway or proxy and received an invalid response from the upstream server.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"BAD_GATEWAY\"] = 502] = \"BAD_GATEWAY\";\r\n    /**\r\n     * The server is currently unavailable (because it is overloaded or down for maintenance).\r\n     * Generally, this is a temporary state.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"SERVICE_UNAVAILABLE\"] = 503] = \"SERVICE_UNAVAILABLE\";\r\n    /**\r\n     * The server was acting as a gateway or proxy and did not receive a timely response from the upstream server.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"GATEWAY_TIMEOUT\"] = 504] = \"GATEWAY_TIMEOUT\";\r\n    /**\r\n     * The server does not support the HTTP protocol version used in the request\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"HTTP_VERSION_NOT_SUPPORTED\"] = 505] = \"HTTP_VERSION_NOT_SUPPORTED\";\r\n    /**\r\n     * Transparent content negotiation for the request results in a circular reference.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"VARIANT_ALSO_NEGOTIATES\"] = 506] = \"VARIANT_ALSO_NEGOTIATES\";\r\n    /**\r\n     * The server is unable to store the representation needed to complete the request.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"INSUFFICIENT_STORAGE\"] = 507] = \"INSUFFICIENT_STORAGE\";\r\n    /**\r\n     * The server detected an infinite loop while processing the request.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"LOOP_DETECTED\"] = 508] = \"LOOP_DETECTED\";\r\n    /**\r\n     * Further extensions to the request are required for the server to fulfill it.\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"NOT_EXTENDED\"] = 510] = \"NOT_EXTENDED\";\r\n    /**\r\n     * The client needs to authenticate to gain network access.\r\n     * Intended for use by intercepting proxies used to control access to the network (e.g., \"captive portals\" used\r\n     * to require agreement to Terms of Service before granting full Internet access via a Wi-Fi hotspot).\r\n     */\r\n    HttpStatusCode[HttpStatusCode[\"NETWORK_AUTHENTICATION_REQUIRED\"] = 511] = \"NETWORK_AUTHENTICATION_REQUIRED\";\r\n})(HttpStatusCode || (HttpStatusCode = {}));\r\nexports.default = HttpStatusCode;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.associate = void 0;\r\nconst sequelize_1 = require(\"sequelize\");\r\nconst sequelize_2 = require(\"./sequelize\");\r\nclass Board extends sequelize_1.Model {\r\n}\r\nBoard.init({\r\n    title: {\r\n        type: sequelize_1.DataTypes.STRING(200),\r\n        allowNull: true,\r\n    },\r\n    content: {\r\n        type: sequelize_1.DataTypes.TEXT,\r\n        allowNull: true,\r\n    },\r\n    nick: {\r\n        type: sequelize_1.DataTypes.STRING(200),\r\n        allowNull: true,\r\n    },\r\n    ridx: {\r\n        type: sequelize_1.DataTypes.INTEGER,\r\n        allowNull: true,\r\n    },\r\n}, {\r\n    sequelize: sequelize_2.sequelize,\r\n    modelName: 'Board',\r\n    tableName: 'boards',\r\n    charset: 'utf8',\r\n    collate: 'utf8_general_ci',\r\n});\r\nconst associate = (db) => {\r\n};\r\nexports.associate = associate;\r\nexports.default = Board;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.associate = void 0;\r\nconst sequelize_1 = require(\"sequelize\");\r\nconst sequelize_2 = require(\"./sequelize\");\r\nclass Domain extends sequelize_1.Model {\r\n}\r\nDomain.init({\r\n    host: {\r\n        type: sequelize_1.DataTypes.STRING(80),\r\n        allowNull: false\r\n    },\r\n    clientSecret: {\r\n        type: sequelize_1.DataTypes.UUID,\r\n        allowNull: false\r\n    }\r\n}, {\r\n    sequelize: sequelize_2.sequelize,\r\n    modelName: 'Domain',\r\n    tableName: 'domains',\r\n    charset: 'utf8',\r\n    collate: 'utf8_general_ci',\r\n});\r\nconst associate = (db) => {\r\n    //db.Log.belongsTo(db.Record);\r\n};\r\nexports.associate = associate;\r\nexports.default = Domain;\r\n","\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\r\n};\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n__exportStar(require(\"./sequelize\"), exports);\r\nconst domain_1 = __importStar(require(\"./domain\"));\r\nconst board_1 = __importStar(require(\"./board\"));\r\n//모델 초기화\r\nconst db = {\r\n    Domain: domain_1.default,\r\n    Board: board_1.default\r\n};\r\n//모델 관계설정\r\ndomain_1.associate(db);\r\nboard_1.associate(db);\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.associate = void 0;\r\nconst sequelize_1 = require(\"sequelize\");\r\nconst sequelize_2 = require(\"./sequelize\");\r\nclass Resource extends sequelize_1.Model {\r\n}\r\nResource.init({\r\n    path: {\r\n        type: sequelize_1.DataTypes.STRING(300),\r\n    },\r\n    originName: {\r\n        type: sequelize_1.DataTypes.STRING(200),\r\n    },\r\n    savedFileName: {\r\n        type: sequelize_1.DataTypes.STRING(200),\r\n    },\r\n    fileSize: {\r\n        type: sequelize_1.DataTypes.INTEGER,\r\n    },\r\n    mimeType: {\r\n        type: sequelize_1.DataTypes.STRING(200),\r\n    },\r\n}, {\r\n    sequelize: sequelize_2.sequelize,\r\n    modelName: 'Resource',\r\n    tableName: 'resources',\r\n    charset: 'utf8',\r\n    collate: 'utf8_general_ci',\r\n});\r\nconst associate = (db) => {\r\n};\r\nexports.associate = associate;\r\nexports.default = Resource;\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.sequelize = void 0;\r\nconst sequelize_1 = require(\"sequelize\");\r\nconst config_1 = __importDefault(require(\"../config/config\"));\r\nconst env = process.env.NODE_ENV || 'development';\r\nconst { database, username, password } = config_1.default[env];\r\nconst sequelize = new sequelize_1.Sequelize(database, username, password, config_1.default[env]);\r\nexports.sequelize = sequelize;\r\nexports.default = sequelize;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RegisterRoutes = void 0;\r\n/* tslint:disable */\r\n/* eslint-disable */\r\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\nconst tsoa_1 = require(\"tsoa\");\r\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\nconst auth_controller_1 = require(\"./../controller/auth.controller\");\r\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\nconst board_controller_1 = require(\"./../controller/board.controller\");\r\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\nconst domain_controller_1 = require(\"./../controller/domain.controller\");\r\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\nconst resource_controller_1 = require(\"./../controller/resource.controller\");\r\nconst auth_1 = require(\"../services/auth\");\r\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\nconst models = {\r\n    \"JwtAuthModel\": {\r\n        \"dataType\": \"refObject\",\r\n        \"properties\": {\r\n            \"code\": { \"dataType\": \"double\", \"required\": true },\r\n            \"message\": { \"dataType\": \"string\", \"required\": true },\r\n            \"token\": { \"dataType\": \"any\" },\r\n        },\r\n        \"additionalProperties\": true,\r\n    },\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    \"ResponseModel\": {\r\n        \"dataType\": \"refObject\",\r\n        \"properties\": {\r\n            \"success\": { \"dataType\": \"boolean\", \"required\": true },\r\n            \"message\": { \"dataType\": \"string\", \"required\": true },\r\n            \"data\": { \"dataType\": \"any\", \"required\": true },\r\n            \"code\": { \"dataType\": \"double\", \"required\": true },\r\n        },\r\n        \"additionalProperties\": true,\r\n    },\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    \"BoardFormModel\": {\r\n        \"dataType\": \"refObject\",\r\n        \"properties\": {\r\n            \"id\": { \"dataType\": \"double\" },\r\n            \"title\": { \"dataType\": \"string\" },\r\n            \"content\": { \"dataType\": \"string\" },\r\n            \"nick\": { \"dataType\": \"string\" },\r\n            \"ridx\": { \"dataType\": \"double\" },\r\n        },\r\n        \"additionalProperties\": true,\r\n    },\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    \"DomainModel\": {\r\n        \"dataType\": \"refObject\",\r\n        \"properties\": {\r\n            \"id\": { \"dataType\": \"double\", \"required\": true },\r\n            \"host\": { \"dataType\": \"string\", \"required\": true },\r\n            \"clientSecret\": { \"dataType\": \"string\" },\r\n        },\r\n        \"additionalProperties\": true,\r\n    },\r\n};\r\nconst validationService = new tsoa_1.ValidationService(models);\r\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\nfunction RegisterRoutes(app) {\r\n    // ###########################################################################################################\r\n    //  NOTE: If you do not see routes for all of your controllers in this file, then you might not have informed tsoa of where to look\r\n    //      Please look into the \"controllerPathGlobs\" config option described in the readme: https://github.com/lukeautry/tsoa\r\n    // ###########################################################################################################\r\n    app.post('/api/v1/auth/token', function (request, response, next) {\r\n        const args = {\r\n            req: { \"in\": \"request\", \"name\": \"req\", \"required\": true, \"dataType\": \"object\" },\r\n            body: { \"in\": \"body\", \"name\": \"body\", \"required\": true, \"dataType\": \"any\" },\r\n        };\r\n        // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n        let validatedArgs = [];\r\n        try {\r\n            validatedArgs = getValidatedArgs(args, request);\r\n        }\r\n        catch (err) {\r\n            return next(err);\r\n        }\r\n        const controller = new auth_controller_1.AuthController();\r\n        const promise = controller.token_issue.apply(controller, validatedArgs);\r\n        promiseHandler(controller, promise, response, next);\r\n    });\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    app.get('/api/v1/board', authenticateMiddleware([{ \"jwt\": [] }]), function (request, response, next) {\r\n        const args = {\r\n            req: { \"in\": \"request\", \"name\": \"req\", \"required\": true, \"dataType\": \"object\" },\r\n            page: { \"in\": \"query\", \"name\": \"page\", \"required\": true, \"dataType\": \"double\" },\r\n            pageSize: { \"in\": \"query\", \"name\": \"pageSize\", \"required\": true, \"dataType\": \"double\" },\r\n            maxSize: { \"in\": \"query\", \"name\": \"maxSize\", \"required\": true, \"dataType\": \"double\" },\r\n        };\r\n        // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n        let validatedArgs = [];\r\n        try {\r\n            validatedArgs = getValidatedArgs(args, request);\r\n        }\r\n        catch (err) {\r\n            return next(err);\r\n        }\r\n        const controller = new board_controller_1.BoardController();\r\n        const promise = controller.select_list.apply(controller, validatedArgs);\r\n        promiseHandler(controller, promise, response, next);\r\n    });\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    app.get('/api/v1/board/:id', authenticateMiddleware([{ \"jwt\": [] }]), function (request, response, next) {\r\n        const args = {\r\n            req: { \"in\": \"request\", \"name\": \"req\", \"required\": true, \"dataType\": \"object\" },\r\n            id: { \"in\": \"path\", \"name\": \"id\", \"required\": true, \"dataType\": \"double\" },\r\n        };\r\n        // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n        let validatedArgs = [];\r\n        try {\r\n            validatedArgs = getValidatedArgs(args, request);\r\n        }\r\n        catch (err) {\r\n            return next(err);\r\n        }\r\n        const controller = new board_controller_1.BoardController();\r\n        const promise = controller.select_one.apply(controller, validatedArgs);\r\n        promiseHandler(controller, promise, response, next);\r\n    });\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    app.post('/api/v1/board', authenticateMiddleware([{ \"jwt\": [] }]), function (request, response, next) {\r\n        const args = {\r\n            req: { \"in\": \"request\", \"name\": \"req\", \"required\": true, \"dataType\": \"object\" },\r\n            form: { \"in\": \"body\", \"name\": \"form\", \"required\": true, \"ref\": \"BoardFormModel\" },\r\n        };\r\n        // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n        let validatedArgs = [];\r\n        try {\r\n            validatedArgs = getValidatedArgs(args, request);\r\n        }\r\n        catch (err) {\r\n            return next(err);\r\n        }\r\n        const controller = new board_controller_1.BoardController();\r\n        const promise = controller.insert_board.apply(controller, validatedArgs);\r\n        promiseHandler(controller, promise, response, next);\r\n    });\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    app.post('/api/v1/domain', function (request, response, next) {\r\n        const args = {\r\n            req: { \"in\": \"request\", \"name\": \"req\", \"required\": true, \"dataType\": \"object\" },\r\n            form: { \"in\": \"body\", \"name\": \"form\", \"required\": true, \"ref\": \"DomainModel\" },\r\n        };\r\n        // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n        let validatedArgs = [];\r\n        try {\r\n            validatedArgs = getValidatedArgs(args, request);\r\n        }\r\n        catch (err) {\r\n            return next(err);\r\n        }\r\n        const controller = new domain_controller_1.DomainController();\r\n        const promise = controller.insert.apply(controller, validatedArgs);\r\n        promiseHandler(controller, promise, response, next);\r\n    });\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    app.get('/api/v1/domain', function (request, response, next) {\r\n        const args = {\r\n            req: { \"in\": \"request\", \"name\": \"req\", \"required\": true, \"dataType\": \"object\" },\r\n        };\r\n        // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n        let validatedArgs = [];\r\n        try {\r\n            validatedArgs = getValidatedArgs(args, request);\r\n        }\r\n        catch (err) {\r\n            return next(err);\r\n        }\r\n        const controller = new domain_controller_1.DomainController();\r\n        const promise = controller.select_all.apply(controller, validatedArgs);\r\n        promiseHandler(controller, promise, response, next);\r\n    });\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    app.post('/api/v1/resource/single', function (request, response, next) {\r\n        const args = {\r\n            req: { \"in\": \"request\", \"name\": \"req\", \"required\": true, \"dataType\": \"object\" },\r\n        };\r\n        // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n        let validatedArgs = [];\r\n        try {\r\n            validatedArgs = getValidatedArgs(args, request);\r\n        }\r\n        catch (err) {\r\n            return next(err);\r\n        }\r\n        const controller = new resource_controller_1.ResourceController();\r\n        const promise = controller.insert.apply(controller, validatedArgs);\r\n        promiseHandler(controller, promise, response, next);\r\n    });\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    app.get('/api/v1/resource/image', function (request, response, next) {\r\n        const args = {\r\n            request: { \"in\": \"request\", \"name\": \"request\", \"required\": true, \"dataType\": \"object\" },\r\n            id: { \"in\": \"query\", \"name\": \"id\", \"required\": true, \"dataType\": \"double\" },\r\n        };\r\n        // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n        let validatedArgs = [];\r\n        try {\r\n            validatedArgs = getValidatedArgs(args, request);\r\n        }\r\n        catch (err) {\r\n            return next(err);\r\n        }\r\n        const controller = new resource_controller_1.ResourceController();\r\n        const promise = controller.getImage.apply(controller, validatedArgs);\r\n        promiseHandler(controller, promise, response, next);\r\n    });\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    function authenticateMiddleware(security = []) {\r\n        return (request, _response, next) => {\r\n            let responded = 0;\r\n            let success = false;\r\n            const succeed = function (user) {\r\n                if (!success) {\r\n                    success = true;\r\n                    responded++;\r\n                    request['user'] = user;\r\n                    next();\r\n                }\r\n            };\r\n            // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n            const fail = function (error) {\r\n                responded++;\r\n                if (responded == security.length && !success) {\r\n                    error.status = error.status || 401;\r\n                    next(error);\r\n                }\r\n            };\r\n            // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n            for (const secMethod of security) {\r\n                if (Object.keys(secMethod).length > 1) {\r\n                    let promises = [];\r\n                    for (const name in secMethod) {\r\n                        promises.push(auth_1.expressAuthentication(request, name, secMethod[name]));\r\n                    }\r\n                    Promise.all(promises)\r\n                        .then((users) => { succeed(users[0]); })\r\n                        .catch(fail);\r\n                }\r\n                else {\r\n                    for (const name in secMethod) {\r\n                        auth_1.expressAuthentication(request, name, secMethod[name])\r\n                            .then(succeed)\r\n                            .catch(fail);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n    }\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    function isController(object) {\r\n        return 'getHeaders' in object && 'getStatus' in object && 'setStatus' in object;\r\n    }\r\n    function promiseHandler(controllerObj, promise, response, next) {\r\n        return Promise.resolve(promise)\r\n            .then((data) => {\r\n            let statusCode;\r\n            if (isController(controllerObj)) {\r\n                const headers = controllerObj.getHeaders();\r\n                Object.keys(headers).forEach((name) => {\r\n                    response.set(name, headers[name]);\r\n                });\r\n                statusCode = controllerObj.getStatus();\r\n            }\r\n            // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n            if (data && typeof data.pipe === 'function' && data.readable && typeof data._read === 'function') {\r\n                data.pipe(response);\r\n            }\r\n            else if (data || data === false) { // === false allows boolean result\r\n                response.status(statusCode || 200).json(data);\r\n            }\r\n            else {\r\n                response.status(statusCode || 204).end();\r\n            }\r\n        })\r\n            .catch((error) => next(error));\r\n    }\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n    function getValidatedArgs(args, request) {\r\n        const fieldErrors = {};\r\n        const values = Object.keys(args).map((key) => {\r\n            const name = args[key].name;\r\n            switch (args[key].in) {\r\n                case 'request':\r\n                    return request;\r\n                case 'query':\r\n                    return validationService.ValidateParam(args[key], request.query[name], name, fieldErrors, undefined, { \"controllerPathGlobs\": [\"./src/controller/*.controller.ts\"], \"specVersion\": 3 });\r\n                case 'path':\r\n                    return validationService.ValidateParam(args[key], request.params[name], name, fieldErrors, undefined, { \"controllerPathGlobs\": [\"./src/controller/*.controller.ts\"], \"specVersion\": 3 });\r\n                case 'header':\r\n                    return validationService.ValidateParam(args[key], request.header(name), name, fieldErrors, undefined, { \"controllerPathGlobs\": [\"./src/controller/*.controller.ts\"], \"specVersion\": 3 });\r\n                case 'body':\r\n                    return validationService.ValidateParam(args[key], request.body, name, fieldErrors, name + '.', { \"controllerPathGlobs\": [\"./src/controller/*.controller.ts\"], \"specVersion\": 3 });\r\n                case 'body-prop':\r\n                    return validationService.ValidateParam(args[key], request.body[name], name, fieldErrors, 'body.', { \"controllerPathGlobs\": [\"./src/controller/*.controller.ts\"], \"specVersion\": 3 });\r\n            }\r\n        });\r\n        if (Object.keys(fieldErrors).length > 0) {\r\n            throw new tsoa_1.ValidateError(fieldErrors, '');\r\n        }\r\n        return values;\r\n    }\r\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n}\r\nexports.RegisterRoutes = RegisterRoutes;\r\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n// src/server.ts\r\nconst winston_1 = __importDefault(require(\"./config/winston\"));\r\nconst app_1 = require(\"./app\");\r\napp_1.app.listen(app_1.app.get('port'), () => winston_1.default.info(`Example app listening at http://${app_1.app.get('host')}:${app_1.app.get('port')}`));\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.noneAuth = exports.jwtAuth = exports.expressAuthentication = void 0;\r\nconst jsonwebtoken_1 = __importDefault(require(\"jsonwebtoken\"));\r\nconst defineCode_1 = __importDefault(require(\"../enum/defineCode\"));\r\nconst httpStatusCode_1 = __importDefault(require(\"../enum/httpStatusCode\"));\r\n/**\r\n * Is called before each request to a protected api-resource.\r\n * @param req The request.\r\n * @param name The name of the wanted security from the securityDefinitions.\r\n * @param scopes The required scopes.\r\n * @see https://github.com/lukeautry/tsoa#authentication\r\n */\r\nfunction expressAuthentication(req, securityName, scopes) {\r\n    const res = req.res;\r\n    switch (securityName) {\r\n        case 'jwt':\r\n            return exports.jwtAuth(req, res, scopes);\r\n        default:\r\n            return exports.noneAuth(req, res);\r\n    }\r\n}\r\nexports.expressAuthentication = expressAuthentication;\r\nconst jwtAuth = (req, res, scopes, _token) => {\r\n    return new Promise((resolve, reject) => {\r\n        try {\r\n            const token = (req.get('Authorization') || 'Bearer ').split('Bearer ')[1] || _token;\r\n            const secret = `${process.env.JWT_SECRET}`;\r\n            const decoded = jsonwebtoken_1.default.verify(token, secret);\r\n            console.log('토큰', token, secret, decoded);\r\n            if (decoded) {\r\n                console.log('인증 성공', decoded);\r\n                resolve({});\r\n            }\r\n            else {\r\n                console.log('인증 실패');\r\n                reject(new Error(`${defineCode_1.default.ERROR_CODE_AUTH_FAILED}Empty decoded refresh token.`));\r\n            }\r\n        }\r\n        catch (error) {\r\n            console.log('인증 실패!');\r\n            console.log(error);\r\n            reject(error);\r\n        }\r\n    })\r\n        .catch(error => {\r\n        if (error.name == 'TokenExpiredError') {\r\n            res.status(419);\r\n            res.send({\r\n                success: false,\r\n                message: error.message,\r\n                code: error.message.match(/(\\[[0-9]{3}\\])(\\w+)/) && error.message.match(/(\\[[0-9]{3}\\])(\\w+)/).length === 3 ? error.message.match(/(\\[[0-9]{3}\\])(\\w+)/)[1] : defineCode_1.default.ERROR_CODE_OTHER\r\n            });\r\n            return;\r\n        }\r\n        res.status(httpStatusCode_1.default.UNAUTHORIZED);\r\n        res.send({\r\n            success: false,\r\n            message: error.message,\r\n            code: error.message.match(/(\\[[0-9]{3}\\])(\\w+)/) && error.message.match(/(\\[[0-9]{3}\\])(\\w+)/).length === 3 ? error.message.match(/(\\[[0-9]{3}\\])(\\w+)/)[1] : defineCode_1.default.ERROR_CODE_OTHER\r\n        });\r\n    });\r\n};\r\nexports.jwtAuth = jwtAuth;\r\nconst noneAuth = (req, res) => {\r\n    return new Promise((resolve, reject) => {\r\n        resolve({});\r\n    })\r\n        .catch(err => {\r\n        res.status(httpStatusCode_1.default.UNAUTHORIZED);\r\n        res.send({\r\n            success: false,\r\n            message: err.message,\r\n            code: err.message.match(/(\\[[0-9]{3}\\])(\\w+)/) && err.message.match(/(\\[[0-9]{3}\\])(\\w+)/).length === 3 ? err.message.match(/(\\[[0-9]{3}\\])(\\w+)/)[1] : defineCode_1.default.ERROR_CODE_OTHER\r\n        });\r\n    });\r\n};\r\nexports.noneAuth = noneAuth;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.insert = exports.selectOne = exports.selectList = void 0;\r\nconst board_1 = __importDefault(require(\"../models/board\"));\r\nconst httpStatusCode_1 = __importDefault(require(\"../enum/httpStatusCode\"));\r\nconst selectList = (page) => __awaiter(void 0, void 0, void 0, function* () {\r\n    return new Promise((resolve, reject) => __awaiter(void 0, void 0, void 0, function* () {\r\n        const curPage = page.page || 1;\r\n        const skipSize = (curPage - 1) * page.pageSize;\r\n        const collectionSize = yield board_1.default.count();\r\n        try {\r\n            const data = yield board_1.default.findAll({\r\n                order: [['createdAt', 'DESC']],\r\n                limit: page.pageSize,\r\n                offset: skipSize\r\n            });\r\n            if (data.length <= 0) {\r\n                resolve({\r\n                    success: true,\r\n                    message: \"결과가 존재하지 않습니다.\",\r\n                    data: null,\r\n                    code: httpStatusCode_1.default.NO_CONTENT\r\n                });\r\n            }\r\n            resolve({\r\n                success: true,\r\n                message: \"게시물 목록을 불러왔습니다.\",\r\n                data: {\r\n                    list: data,\r\n                    pager: {\r\n                        collectionSize: collectionSize,\r\n                        page: curPage,\r\n                        maxSize: page.maxSize,\r\n                        pageSize: page.pageSize,\r\n                    }\r\n                },\r\n                code: httpStatusCode_1.default.OK\r\n            });\r\n        }\r\n        catch (error) {\r\n            reject(error);\r\n        }\r\n    }));\r\n});\r\nexports.selectList = selectList;\r\nconst selectOne = (id) => __awaiter(void 0, void 0, void 0, function* () {\r\n    return new Promise((resolve, reject) => __awaiter(void 0, void 0, void 0, function* () {\r\n        try {\r\n            const data = yield board_1.default.findOne({\r\n                where: { id: id }\r\n            });\r\n            if (data) {\r\n                console.log(data);\r\n                resolve({\r\n                    success: true,\r\n                    message: \"불러오기 성공\",\r\n                    data: data,\r\n                    code: httpStatusCode_1.default.OK\r\n                });\r\n            }\r\n            resolve({\r\n                success: true,\r\n                message: \"결과가 존재하지 않습니다.\",\r\n                data: null,\r\n                code: httpStatusCode_1.default.NO_CONTENT\r\n            });\r\n        }\r\n        catch (error) {\r\n            reject(error);\r\n        }\r\n    }));\r\n});\r\nexports.selectOne = selectOne;\r\nconst insert = (form) => __awaiter(void 0, void 0, void 0, function* () {\r\n    return new Promise((resolve, reject) => __awaiter(void 0, void 0, void 0, function* () {\r\n        try {\r\n            const { title, content, nick, ridx } = form;\r\n            yield board_1.default.create({\r\n                title: title,\r\n                content: content,\r\n                nick: nick,\r\n                ridx: ridx\r\n            });\r\n            resolve({\r\n                success: true,\r\n                message: \"게시 성공\",\r\n                data: null,\r\n                code: httpStatusCode_1.default.OK\r\n            });\r\n        }\r\n        catch (error) {\r\n            console.error(error);\r\n            reject(error);\r\n        }\r\n    }));\r\n});\r\nexports.insert = insert;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.selectAllDomain = exports.insertDomain = void 0;\r\nconst domain_1 = __importDefault(require(\"../models/domain\"));\r\nconst uuid_1 = require(\"uuid\");\r\nconst httpStatusCode_1 = __importDefault(require(\"../enum/httpStatusCode\"));\r\nconst insertDomain = (host) => __awaiter(void 0, void 0, void 0, function* () {\r\n    return new Promise((resolve, reject) => __awaiter(void 0, void 0, void 0, function* () {\r\n        try {\r\n            const exist = yield domain_1.default.findOne({ where: { host: host } });\r\n            console.log(exist);\r\n            if (exist) { //중복 존재시             \r\n                resolve({\r\n                    success: false,\r\n                    message: 'Exist Host',\r\n                    code: 412,\r\n                });\r\n            }\r\n            const secret = uuid_1.v4();\r\n            yield domain_1.default.create({\r\n                host,\r\n                clientSecret: secret\r\n            });\r\n            resolve({\r\n                success: true,\r\n                message: 'Insert Host Complete',\r\n                code: 200,\r\n            });\r\n        }\r\n        catch (error) {\r\n            console.error(error);\r\n            reject(error);\r\n        }\r\n    }));\r\n});\r\nexports.insertDomain = insertDomain;\r\nconst selectAllDomain = () => __awaiter(void 0, void 0, void 0, function* () {\r\n    return new Promise((resolve, reject) => __awaiter(void 0, void 0, void 0, function* () {\r\n        try {\r\n            const data = yield domain_1.default.findAll({});\r\n            resolve({\r\n                success: true,\r\n                message: \"도메인 목록을 불러왔습니다.\",\r\n                data: {\r\n                    list: data,\r\n                },\r\n                code: httpStatusCode_1.default.OK\r\n            });\r\n        }\r\n        catch (error) {\r\n            reject(error);\r\n        }\r\n    }));\r\n});\r\nexports.selectAllDomain = selectAllDomain;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.selectOne = exports.handleFile = exports.insertResource = void 0;\r\nconst httpStatusCode_1 = __importDefault(require(\"../enum/httpStatusCode\"));\r\nconst resource_1 = __importDefault(require(\"../models/resource\"));\r\nconst defineCode_1 = __importDefault(require(\"../enum/defineCode\"));\r\nconst multer_1 = __importDefault(require(\"multer\"));\r\nconst insertResource = (resource) => __awaiter(void 0, void 0, void 0, function* () {\r\n    return new Promise((resolve, reject) => __awaiter(void 0, void 0, void 0, function* () {\r\n        try {\r\n            const res = yield resource_1.default.create({\r\n                path: resource.path,\r\n                originName: resource.originName,\r\n                savedFileName: resource.savedFileName,\r\n                fileSize: resource.fileSize,\r\n                mimeType: resource.mimeType\r\n            });\r\n            resolve({\r\n                success: true,\r\n                message: \"리소스 저장 성공\",\r\n                data: {\r\n                    id: res.id,\r\n                },\r\n                code: httpStatusCode_1.default.OK\r\n            });\r\n        }\r\n        catch (error) {\r\n            reject(error);\r\n        }\r\n    }));\r\n});\r\nexports.insertResource = insertResource;\r\nconst handleFile = (request) => {\r\n    console.log('handling');\r\n    return new Promise((resolve, reject) => {\r\n        try {\r\n            const file = multer_1.default({\r\n                dest: defineCode_1.default.RESOURCE_PATH,\r\n                limits: {\r\n                    fileSize: defineCode_1.default.RESOURCE_MAX_SIZE\r\n                },\r\n            }).single('file');\r\n            file(request, undefined, (err) => __awaiter(void 0, void 0, void 0, function* () {\r\n                if (err) {\r\n                    console.log(err);\r\n                    reject(err);\r\n                    return;\r\n                }\r\n                resolve({\r\n                    form: request.body,\r\n                    resource: request.file\r\n                });\r\n            }));\r\n        }\r\n        catch (err) {\r\n            reject(err);\r\n        }\r\n    })\r\n        .catch(err => err);\r\n};\r\nexports.handleFile = handleFile;\r\nconst selectOne = (id) => __awaiter(void 0, void 0, void 0, function* () {\r\n    return new Promise((resolve, reject) => __awaiter(void 0, void 0, void 0, function* () {\r\n        try {\r\n            const data = yield resource_1.default.findOne({\r\n                where: { id: id }\r\n            });\r\n            if (data) {\r\n                resolve({\r\n                    success: true,\r\n                    message: \"불러오기 성공\",\r\n                    data: data,\r\n                    code: httpStatusCode_1.default.OK\r\n                });\r\n            }\r\n            resolve({\r\n                success: false,\r\n                message: \"결과가 존재하지 않습니다.\",\r\n                data: null,\r\n                code: httpStatusCode_1.default.NO_CONTENT\r\n            });\r\n        }\r\n        catch (error) {\r\n            reject(error);\r\n        }\r\n    }));\r\n});\r\nexports.selectOne = selectOne;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.get_token = void 0;\r\nconst domain_1 = __importDefault(require(\"../models/domain\"));\r\nconst httpStatusCode_1 = __importDefault(require(\"../enum/httpStatusCode\"));\r\nconst jsonwebtoken_1 = __importDefault(require(\"jsonwebtoken\"));\r\nconst get_token = (clientSecret) => __awaiter(void 0, void 0, void 0, function* () {\r\n    return new Promise((resolve, reject) => __awaiter(void 0, void 0, void 0, function* () {\r\n        try {\r\n            const domain = yield domain_1.default.findOne({\r\n                where: { clientSecret },\r\n            });\r\n            if (!domain) {\r\n                resolve({\r\n                    code: httpStatusCode_1.default.UNAUTHORIZED,\r\n                    message: '토큰 발급 실패',\r\n                });\r\n            }\r\n            let secret;\r\n            secret = process.env.JWT_SECRET;\r\n            const token = jsonwebtoken_1.default.sign({\r\n                name: \"sjh\"\r\n            }, secret, {\r\n                expiresIn: '1m',\r\n                issuer: 'board-service',\r\n            });\r\n            resolve({\r\n                code: httpStatusCode_1.default.OK,\r\n                message: '토큰이 발급되었습니다',\r\n                token: token,\r\n            });\r\n        }\r\n        catch (error) {\r\n            console.error(error);\r\n            reject(error);\r\n        }\r\n    }));\r\n});\r\nexports.get_token = get_token;\r\n","module.exports = require(\"app-root-path\");;","module.exports = require(\"body-parser\");;","module.exports = require(\"cookie-parser\");;","module.exports = require(\"cors\");;","module.exports = require(\"dotenv\");;","module.exports = require(\"express\");;","module.exports = require(\"express-ip\");;","module.exports = require(\"express-session\");;","module.exports = require(\"fs\");;","module.exports = require(\"jsonfile\");;","module.exports = require(\"jsonwebtoken\");;","module.exports = require(\"moment-timezone\");;","module.exports = require(\"morgan\");;","module.exports = require(\"multer\");;","module.exports = require(\"path\");;","module.exports = require(\"sequelize\");;","module.exports = require(\"split\");;","module.exports = require(\"swagger-ui-express\");;","module.exports = require(\"tsoa\");;","module.exports = require(\"uuid\");;","module.exports = require(\"winston\");;","module.exports = require(\"winston-daily-rotate-file\");;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"\";","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(728);\n"],"sourceRoot":""}